import{B as Re}from"./chunk-FHPH46MZ.js";import{g as ze}from"./chunk-ZBGVERMW.js";import{f as K}from"./chunk-LVHII46P.js";import{n as ve}from"./chunk-RD6NJ7NY.js";import{$ as ie,Ba as Ce,Bb as V,C as te,Ca as m,Da as g,Fb as ne,Gb as R,Hb as P,Ib as X,Ka as z,La as Me,Nb as q,Sb as l,T as _e,Tb as c,Ub as M,Vb as Ae,Vc as Ie,Wb as be,Yb as k,dc as x,ec as h,f as fe,fb as Y,hb as we,kb as y,kc as ae,lb as S,lc as oe,mc as se,qc as w,ra as j,ub as ye,yc as N,z as O}from"./chunk-3TFDHLSU.js";import{a as u,b as T,g as I}from"./chunk-GAL4ENT6.js";var We=["wrapper"],Le=["sourceImage"];function Qe(o,e){if(o&1){let t=k();l(0,"img",5,0),x("load",function(){m(t);let n=h();return g(n.imageLoadedInView())})("mousedown",function(n){m(t);let a=h();return g(a.startMove(n,a.moveTypes.Drag))})("touchstart",function(n){m(t);let a=h();return g(a.startMove(n,a.moveTypes.Drag))})("error",function(n){m(t);let a=h();return g(a.loadImageError(n))}),c()}if(o&2){let t=e.ngIf,i=h();P("visibility",i.imageVisible?"visible":"hidden")("transform",i.safeTransformStyle),X("ngx-ic-draggable",!i.disabled&&i.allowMoveImage),R("src",t,Y),ne("alt",i.imageAltText)}}function De(o,e){if(o&1){let t=k();Ae(0),l(1,"span",9),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"topleft"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"topleft"))}),M(2,"span",10),c(),l(3,"span",11),M(4,"span",10),c(),l(5,"span",12),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"topright"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"topright"))}),M(6,"span",10),c(),l(7,"span",13),M(8,"span",10),c(),l(9,"span",14),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"bottomright"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"bottomright"))}),M(10,"span",10),c(),l(11,"span",15),M(12,"span",10),c(),l(13,"span",16),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"bottomleft"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"bottomleft"))}),M(14,"span",10),c(),l(15,"span",17),M(16,"span",10),c(),l(17,"span",18),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"top"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"top"))}),c(),l(18,"span",19),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"right"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"right"))}),c(),l(19,"span",20),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"bottom"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"bottom"))}),c(),l(20,"span",21),x("mousedown",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"left"))})("touchstart",function(n){m(t);let a=h(2);return g(a.startMove(n,a.moveTypes.Resize,"left"))}),c(),be()}}function je(o,e){if(o&1){let t=k();l(0,"div",6),x("keydown",function(n){m(t);let a=h();return g(a.keyboardAccess(n))}),l(1,"div",7),x("mousedown",function(n){m(t);let a=h();return g(a.startMove(n,a.moveTypes.Move))})("touchstart",function(n){m(t);let a=h();return g(a.startMove(n,a.moveTypes.Move))}),c(),V(2,De,21,0,"ng-container",8),c()}if(o&2){let t=h();P("top",t.state.cropper.y1,"px")("left",t.state.cropper.x1,"px")("width",t.state.cropper.x2-t.state.cropper.x1,"px")("height",t.state.cropper.y2-t.state.cropper.y1,"px")("margin-left",t.state.options.alignImage==="center"?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),X("ngx-ic-round",t.state.options.roundCropper),ne("aria-label",t.state.options.cropperFrameAriaLabel),y(2),R("ngIf",!t.state.options.hideResizeSquares&&!(t.state.options.cropperStaticWidth&&t.state.options.cropperStaticHeight))}}function U(o,e,t){return o=Ye(o,e),$(o,e,t)}function Ye(o,e){let t=o.x2-o.x1,i=o.y2-o.y1,n=o.x1+t/2,a=o.y1+i/2;e.options.cropperStaticHeight&&e.options.cropperStaticWidth?(t=e.maxSize.width>e.options.cropperStaticWidth?e.options.cropperStaticWidth:e.maxSize.width,i=e.maxSize.height>e.options.cropperStaticHeight?e.options.cropperStaticHeight:e.maxSize.height):(t=Math.max(e.cropperScaledMinWidth,Math.min(t,e.cropperScaledMaxWidth,e.maxSize.width)),i=Math.max(e.cropperScaledMinHeight,Math.min(i,e.cropperScaledMaxHeight,e.maxSize.height)),e.options.maintainAspectRatio&&(e.maxSize.width/e.options.aspectRatio<e.maxSize.height?i=t/e.options.aspectRatio:t=i*e.options.aspectRatio));let s=n-t/2,r=s+t,p=a-i/2,d=p+i;return{x1:s,x2:r,y1:p,y2:d}}function $(o,e,t=!1){return o.x1<0&&(o=T(u({},o),{x1:0,x2:o.x2-(t?o.x1:0)})),o.y1<0&&(o=T(u({},o),{y2:o.y2-(t?o.y1:0),y1:0})),o.x2>e.maxSize.width&&(o=T(u({},o),{x1:o.x1-(t?o.x2-e.maxSize.width:0),x2:e.maxSize.width})),o.y2>e.maxSize.height&&(o=T(u({},o),{y1:o.y1-(t?o.y2-e.maxSize.height:0),y2:e.maxSize.height})),o}function Xe(o,e){let t=G(o)-e.clientX,i=Z(o)-e.clientY;return{x1:e.cropper.x1+t,y1:e.cropper.y1+i,x2:e.cropper.x2+t,y2:e.cropper.y2+i}}function Ee(o,e,t){let i=u({},t.cropper),n=G(o)-e.clientX,a=Z(o)-e.clientY;switch(e.position){case"left":i.x1=Math.min(Math.max(e.cropper.x1+n,i.x2-t.cropperScaledMaxWidth),i.x2-t.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(e.cropper.x1+n,i.x2-t.cropperScaledMaxWidth),i.x2-t.cropperScaledMinWidth),i.y1=Math.min(Math.max(e.cropper.y1+a,i.y2-t.cropperScaledMaxHeight),i.y2-t.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(e.cropper.y1+a,i.y2-t.cropperScaledMaxHeight),i.y2-t.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(e.cropper.x2+n,i.x1+t.cropperScaledMaxWidth),i.x1+t.cropperScaledMinWidth),i.y1=Math.min(Math.max(e.cropper.y1+a,i.y2-t.cropperScaledMaxHeight),i.y2-t.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(e.cropper.x2+n,i.x1+t.cropperScaledMaxWidth),i.x1+t.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(e.cropper.x2+n,i.x1+t.cropperScaledMaxWidth),i.x1+t.cropperScaledMinWidth),i.y2=Math.max(Math.min(e.cropper.y2+a,i.y1+t.cropperScaledMaxHeight),i.y1+t.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(e.cropper.y2+a,i.y1+t.cropperScaledMaxHeight),i.y1+t.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(e.cropper.x1+n,i.x2-t.cropperScaledMaxWidth),i.x2-t.cropperScaledMinWidth),i.y2=Math.max(Math.min(e.cropper.y2+a,i.y1+t.cropperScaledMaxHeight),i.y1+t.cropperScaledMinHeight);break;case"center":let s="scale"in o?o.scale:1,r=Math.min(Math.max(t.cropperScaledMinWidth,Math.abs(e.cropper.x2-e.cropper.x1)*s),t.cropperScaledMaxWidth),p=Math.min(Math.max(t.cropperScaledMinHeight,Math.abs(e.cropper.y2-e.cropper.y1)*s),t.cropperScaledMaxHeight);i.x1=e.clientX-r/2,i.x2=e.clientX+r/2,i.y1=e.clientY-p/2,i.y2=e.clientY+p/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>t.maxSize.width&&(i.x1-=i.x2-t.maxSize.width,i.x2=t.maxSize.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>t.maxSize.height&&(i.y1-=i.y2-t.maxSize.height,i.y2=t.maxSize.height);break}return t.options.maintainAspectRatio?qe(e.position,i,t):i}function qe(o,e,t){e=u({},e);let i=0,n=0;switch(o){case"top":e.x2=e.x1+(e.y2-e.y1)*t.options.aspectRatio,i=Math.max(e.x2-t.maxSize.width,0),n=Math.max(0-e.y1,0),(i>0||n>0)&&(e.x2-=n*t.options.aspectRatio>i?n*t.options.aspectRatio:i,e.y1+=n*t.options.aspectRatio>i?n:i/t.options.aspectRatio);break;case"bottom":e.x2=e.x1+(e.y2-e.y1)*t.options.aspectRatio,i=Math.max(e.x2-t.maxSize.width,0),n=Math.max(e.y2-t.maxSize.height,0),(i>0||n>0)&&(e.x2-=n*t.options.aspectRatio>i?n*t.options.aspectRatio:i,e.y2-=n*t.options.aspectRatio>i?n:i/t.options.aspectRatio);break;case"topleft":e.y1=e.y2-(e.x2-e.x1)/t.options.aspectRatio,i=Math.max(0-e.x1,0),n=Math.max(0-e.y1,0),(i>0||n>0)&&(e.x1+=n*t.options.aspectRatio>i?n*t.options.aspectRatio:i,e.y1+=n*t.options.aspectRatio>i?n:i/t.options.aspectRatio);break;case"topright":e.y1=e.y2-(e.x2-e.x1)/t.options.aspectRatio,i=Math.max(e.x2-t.maxSize.width,0),n=Math.max(0-e.y1,0),(i>0||n>0)&&(e.x2-=n*t.options.aspectRatio>i?n*t.options.aspectRatio:i,e.y1+=n*t.options.aspectRatio>i?n:i/t.options.aspectRatio);break;case"right":case"bottomright":e.y2=e.y1+(e.x2-e.x1)/t.options.aspectRatio,i=Math.max(e.x2-t.maxSize.width,0),n=Math.max(e.y2-t.maxSize.height,0),(i>0||n>0)&&(e.x2-=n*t.options.aspectRatio>i?n*t.options.aspectRatio:i,e.y2-=n*t.options.aspectRatio>i?n:i/t.options.aspectRatio);break;case"left":case"bottomleft":e.y2=e.y1+(e.x2-e.x1)/t.options.aspectRatio,i=Math.max(0-e.x1,0),n=Math.max(e.y2-t.maxSize.height,0),(i>0||n>0)&&(e.x1+=n*t.options.aspectRatio>i?n*t.options.aspectRatio:i,e.y2-=n*t.options.aspectRatio>i?n:i/t.options.aspectRatio);break;case"center":e.x2=e.x1+(e.y2-e.y1)*t.options.aspectRatio,e.y2=e.y1+(e.x2-e.x1)/t.options.aspectRatio;let a=Math.max(0-e.x1,0),s=Math.max(e.x2-t.maxSize.width,0),r=Math.max(e.y2-t.maxSize.height,0),p=Math.max(0-e.y1,0);(a>0||s>0||r>0||p>0)&&(e.x1+=r*t.options.aspectRatio>a?r*t.options.aspectRatio:a,e.x2-=p*t.options.aspectRatio>s?p*t.options.aspectRatio:s,e.y1+=p*t.options.aspectRatio>s?p:s/t.options.aspectRatio,e.y2-=r*t.options.aspectRatio>a?r:a/t.options.aspectRatio);break}return e}function G(o){return"touches"in o&&o.touches[0]?o.touches[0].clientX:"clientX"in o?o.clientX:0}function Z(o){return"touches"in o&&o.touches[0]?o.touches[0].clientY:"clientX"in o?o.clientY:0}var re=class{constructor(){this.options={format:"png",output:"blob",autoCrop:!0,maintainAspectRatio:!0,aspectRatio:1,resetCropOnAspectRatioChange:!0,resizeToWidth:0,resizeToHeight:0,cropperMinWidth:0,cropperMinHeight:0,cropperMaxHeight:0,cropperMaxWidth:0,cropperStaticWidth:0,cropperStaticHeight:0,canvasRotation:0,roundCropper:!1,onlyScaleDown:!1,imageQuality:92,backgroundColor:null,containWithinAspectRatio:!1,hideResizeSquares:!1,alignImage:"center",cropperFrameAriaLabel:void 0,checkImageType:!0},this.cropper={x1:0,x2:0,y1:0,y2:0},this.transform={},this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=3}setOptionsFromChanges(e){e.options?.currentValue&&this.setOptions(e.options.currentValue);let t=Object.entries(e).filter(([i])=>i in this.options).reduce((i,[n,a])=>T(u({},i),{[n]:a.currentValue}),{});Object.keys(t).length>0&&this.setOptions(t)}setOptions(e){if(this.options=u(u({},this.options),e||{}),this.validateOptions(),!this.loadedImage?.transformed.image.complete||!this.maxSize)return;let t=!1;this.options.maintainAspectRatio&&e.aspectRatio||e.maintainAspectRatio?(this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.options.maintainAspectRatio&&(this.options.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(this.cropper=this.maxSizeCropperPosition(),t=!0)):((e.cropperMinWidth||e.cropperMinHeight)&&(this.setCropperScaledMinSize(),t=!0),(e.cropperMaxWidth||e.cropperMaxHeight)&&(this.setCropperScaledMaxSize(),t=!0),(e.cropperStaticWidth||e.cropperStaticHeight)&&(t=!0)),t&&(this.cropper=U(this.cropper,this,!1))}validateOptions(){if(this.options.maintainAspectRatio&&!this.options.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}setMaxSize(e,t){this.maxSize={width:e,height:t},this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}setCropperScaledMinSize(){this.loadedImage?.transformed.size?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.cropperScaledMinWidth=this.options.cropperMinWidth>0?Math.max(20,this.options.cropperMinWidth/this.loadedImage.transformed.size.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.options.maintainAspectRatio?this.cropperScaledMinHeight=Math.max(20,this.cropperScaledMinWidth/this.options.aspectRatio):this.options.cropperMinHeight>0?this.cropperScaledMinHeight=Math.max(20,this.options.cropperMinHeight/this.loadedImage.transformed.size.height*this.maxSize.height):this.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed.size){let e=this.loadedImage.transformed.size.width/this.maxSize.width;this.cropperScaledMaxWidth=this.options.cropperMaxWidth>20?this.options.cropperMaxWidth/e:this.maxSize.width,this.cropperScaledMaxHeight=this.options.cropperMaxHeight>20?this.options.cropperMaxHeight/e:this.maxSize.height,this.options.maintainAspectRatio&&(this.cropperScaledMaxWidth>this.cropperScaledMaxHeight*this.options.aspectRatio?this.cropperScaledMaxWidth=this.cropperScaledMaxHeight*this.options.aspectRatio:this.cropperScaledMaxWidth<this.cropperScaledMaxHeight*this.options.aspectRatio&&(this.cropperScaledMaxHeight=this.cropperScaledMaxWidth/this.options.aspectRatio))}else this.cropperScaledMaxWidth=this.maxSize.width,this.cropperScaledMaxHeight=this.maxSize.height}equalsCropperPosition(e){return this.cropper==null&&e==null||this.cropper!=null&&e!=null&&this.cropper.x1.toFixed(3)===e.x1.toFixed(3)&&this.cropper.y1.toFixed(3)===e.y1.toFixed(3)&&this.cropper.x2.toFixed(3)===e.x2.toFixed(3)&&this.cropper.y2.toFixed(3)===e.y2.toFixed(3)}equalsTransformTranslate(e){return(this.transform.translateH??0)===(e.translateH??0)&&(this.transform.translateV??0)===(e.translateV??0)}equalsTransform(e){return this.equalsTransformTranslate(e)&&(this.transform.scale??1)===(e.scale??1)&&(this.transform.rotate??0)===(e.rotate??0)&&(this.transform.flipH??!1)===(e.flipH??!1)&&(this.transform.flipV??!1)===(e.flipV??!1)}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.options.aspectRatio}resizeCropperPosition(e){this.cropper&&(e.width!==this.maxSize.width||e.height!==this.maxSize.height)&&(this.cropper={x1:this.cropper.x1*this.maxSize.width/e.width,x2:this.cropper.x2*this.maxSize.width/e.width,y1:this.cropper.y1*this.maxSize.height/e.height,y2:this.cropper.y2*this.maxSize.height/e.height})}maxSizeCropperPosition(){return{x1:0,y1:0,x2:this.maxSize.width,y2:this.maxSize.height}}},C=function(o){return o.Drag="drag",o.Move="move",o.Resize="resize",o.Pinch="pinch",o}(C||{});function Ne(o,e,t){let i=o.width,n=o.height;e=Math.round(e),t=Math.round(t);let a=i/e,s=n/t,r=Math.ceil(a/2),p=Math.ceil(s/2),d=o.getContext("2d");if(d){let E=d.getImageData(0,0,i,n),A=d.createImageData(e,t),f=E.data,_=A.data;for(let b=0;b<t;b++)for(let F=0;F<e;F++){let W=(F+b*e)*4,Fe=b*s,v=0,L=0,le=0,me=0,ge=0,pe=0,de=0,Be=Math.floor(F*a),He=Math.floor(b*s),J=Math.ceil((F+1)*a),ee=Math.ceil((b+1)*s);J=Math.min(J,i),ee=Math.min(ee,n);for(let Q=He;Q<ee;Q++){let ue=Math.abs(Fe-Q)/p,Se=F*a,Pe=ue*ue;for(let D=Be;D<J;D++){let xe=Math.abs(Se-D)/r,B=Math.sqrt(Pe+xe*xe);if(B>=1)continue;v=2*B*B*B-3*B*B+1;let H=4*(D+Q*i);de+=v*f[H+3],le+=v,f[H+3]<255&&(v=v*f[H+3]/250),me+=v*f[H],ge+=v*f[H+1],pe+=v*f[H+2],L+=v}}_[W]=me/L,_[W+1]=ge/L,_[W+2]=pe/L,_[W+3]=de/le}o.width=e,o.height=t,d.putImageData(A,0,0)}}function Te(o,e){return o/100*e}var ce=class{crop(e,t){let i=this.getImagePosition(e),n=i.x2-i.x1,a=i.y2-i.y1,s=document.createElement("canvas");s.width=n,s.height=a;let r=s.getContext("2d");if(!r)return null;e.options.backgroundColor!=null&&(r.fillStyle=e.options.backgroundColor,r.fillRect(0,0,n,a));let p=(e.transform.scale||1)*(e.transform.flipH?-1:1),d=(e.transform.scale||1)*(e.transform.flipV?-1:1),{translateH:E,translateV:A}=this.getCanvasTranslate(e),f=e.loadedImage.transformed;r.setTransform(p,0,0,d,f.size.width/2+E,f.size.height/2+A),r.translate(-i.x1/p,-i.y1/d),r.rotate((e.transform.rotate||0)*Math.PI/180),r.drawImage(f.image,-f.size.width/2,-f.size.height/2);let _={width:n,height:a,imagePosition:i,cropperPosition:u({},e.cropper)};e.options.containWithinAspectRatio&&(_.offsetImagePosition=this.getOffsetImagePosition(e));let b=this.getResizeRatio(n,a,e.options);return b!==1&&(_.width=Math.round(n*b),_.height=e.options.maintainAspectRatio?Math.round(_.width/e.options.aspectRatio):Math.round(a*b),Ne(s,_.width,_.height)),t==="blob"?this.cropToBlob(_,s,e):(_.base64=s.toDataURL("image/"+e.options.format,this.getQuality(e.options)),_)}cropToBlob(e,t,i){return I(this,null,function*(){return e.blob=yield new Promise(n=>t.toBlob(n,"image/"+i.options.format,this.getQuality(i.options))),e.blob&&(e.objectUrl=URL.createObjectURL(e.blob)),e})}getCanvasTranslate(e){if(e.transform.translateUnit==="px"){let t=this.getRatio(e);return{translateH:(e.transform.translateH||0)*t,translateV:(e.transform.translateV||0)*t}}else return{translateH:e.transform.translateH?Te(e.transform.translateH,e.loadedImage.transformed.size.width):0,translateV:e.transform.translateV?Te(e.transform.translateV,e.loadedImage.transformed.size.height):0}}getRatio(e){return e.loadedImage.transformed.size.width/e.maxSize.width}getImagePosition(e){let t=this.getRatio(e),i={x1:Math.round(e.cropper.x1*t),y1:Math.round(e.cropper.y1*t),x2:Math.round(e.cropper.x2*t),y2:Math.round(e.cropper.y2*t)};return e.options.containWithinAspectRatio||(i.x1=Math.max(i.x1,0),i.y1=Math.max(i.y1,0),i.x2=Math.min(i.x2,e.loadedImage.transformed.size.width),i.y2=Math.min(i.y2,e.loadedImage.transformed.size.height)),i}getOffsetImagePosition(e){let t=e.options.canvasRotation+e.loadedImage.exifTransform.rotate,i=this.getRatio(e),n,a;t%2?(n=(e.loadedImage.transformed.size.width-e.loadedImage.original.size.height)/2,a=(e.loadedImage.transformed.size.height-e.loadedImage.original.size.width)/2):(n=(e.loadedImage.transformed.size.width-e.loadedImage.original.size.width)/2,a=(e.loadedImage.transformed.size.height-e.loadedImage.original.size.height)/2);let s={x1:Math.round(e.cropper.x1*i)-n,y1:Math.round(e.cropper.y1*i)-a,x2:Math.round(e.cropper.x2*i)-n,y2:Math.round(e.cropper.y2*i)-a};return e.options.containWithinAspectRatio||(s.x1=Math.max(s.x1,0),s.y1=Math.max(s.y1,0),s.x2=Math.min(s.x2,e.loadedImage.transformed.size.width),s.y2=Math.min(s.y2,e.loadedImage.transformed.size.height)),s}getResizeRatio(e,t,i){let n=i.resizeToWidth/e,a=i.resizeToHeight/t,s=new Array;i.resizeToWidth>0&&s.push(n),i.resizeToHeight>0&&s.push(a);let r=s.length===0?1:Math.min(...s);return r>1&&!i.onlyScaleDown?r:Math.min(r,1)}getQuality(e){return Math.min(1,Math.max(0,e.imageQuality/100))}},Ke="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==";function $e(){return new Promise(o=>{let e=new Image;e.onload=()=>{let t=e.width===1&&e.height===2;o(t)},e.src=Ke})}function Ge(o){switch(typeof o=="object"&&(o=Ze(o)),o){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function Ze(o){let e=new DataView(o);if(e.getUint16(0,!1)!==65496)return-2;let t=e.byteLength,i=2;for(;i<t;){if(e.getUint16(i+2,!1)<=8)return-1;let n=e.getUint16(i,!1);if(i+=2,n==65505){if(e.getUint32(i+=2,!1)!==1165519206)return-1;let a=e.getUint16(i+=6,!1)==18761;i+=e.getUint32(i+4,a);let s=e.getUint16(i,a);i+=2;for(let r=0;r<s;r++)if(e.getUint16(i+r*12,a)==274)return e.getUint16(i+r*12+8,a)}else{if((n&65280)!==65280)break;i+=e.getUint16(i,!1)}}return-1}var he=class{constructor(){this.autoRotateSupported=$e()}loadImageFile(e,t){return I(this,null,function*(){let i=yield e.arrayBuffer();return t.options.checkImageType?yield this.checkImageTypeAndLoadImageFromArrayBuffer(i,e.type,t):yield this.loadImageFromArrayBuffer(i,t)})}checkImageTypeAndLoadImageFromArrayBuffer(e,t,i){return this.isValidImageType(t)?this.loadImageFromArrayBuffer(e,i,t):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|heic|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,t){return I(this,null,function*(){let n=yield(yield fetch(e)).blob(),a=yield n.arrayBuffer();return yield this.loadImageFromArrayBuffer(a,t,n.type)})}loadBase64Image(e,t){let i=this.base64ToArrayBuffer(e);return this.loadImageFromArrayBuffer(i,t)}base64ToArrayBuffer(e){e=e.replace(/^data:([^;]+);base64,/gmi,"");let t=atob(e),i=t.length,n=new Uint8Array(i);for(let a=0;a<i;a++)n[a]=t.charCodeAt(a);return n.buffer}loadImageFromArrayBuffer(e,t,i){return I(this,null,function*(){let n=yield new Promise((a,s)=>I(this,null,function*(){try{let r=new Blob([e],i?{type:i}:void 0),p=URL.createObjectURL(r),d=new Image,A=i==="image/svg+xml"?yield this.getSvgImageSize(r):void 0;d.onload=()=>a({originalImage:d,originalImageSize:A,originalObjectUrl:p,originalArrayBuffer:e}),d.onerror=s,d.src=p}catch(r){s(r)}}));return yield this.transformImageFromArrayBuffer(n,t,n.originalImageSize!=null)})}getSvgImageSize(e){return I(this,null,function*(){let n=new DOMParser().parseFromString(yield e.text(),"image/svg+xml").querySelector("svg");if(!n)throw Error("Failed to parse SVG image");let a=n.getAttribute("width"),s=n.getAttribute("height");if(a&&s)return null;let r=n.getAttribute("viewBox")||n.getAttribute("viewbox");if(r){let p=r.split(" ");return{width:+p[2],height:+p[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(e,t,i=!1){return I(this,null,function*(){let n=yield this.autoRotateSupported,a=Ge(n?-1:e.originalArrayBuffer);if(!e.originalImage||!e.originalImage.complete)return Promise.reject(new Error("No image loaded"));let s={original:{objectUrl:e.originalObjectUrl,image:e.originalImage,size:e.originalImageSize??{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:a};return this.transformLoadedImage(s,t,i)})}transformLoadedImage(e,t,i=!1){return I(this,null,function*(){let n=t.options.canvasRotation+e.exifTransform.rotate,a=e.original.size;if(!i&&n===0&&!e.exifTransform.flip&&!t.options.containWithinAspectRatio)return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:u({},a)},transformed:{objectUrl:e.original.objectUrl,image:e.original.image,size:u({},a)},exifTransform:e.exifTransform};let s=this.getTransformedSize(a,e.exifTransform,t),r=document.createElement("canvas");r.width=s.width,r.height=s.height;let p=r.getContext("2d");p?.setTransform(e.exifTransform.flip?-1:1,0,0,1,r.width/2,r.height/2),p?.rotate(Math.PI*(n/2)),p?.drawImage(e.original.image,-a.width/2,-a.height/2);let d=yield new Promise(f=>r.toBlob(f,t.options.format));if(!d)throw new Error("Failed to get Blob for transformed image.");let E=URL.createObjectURL(d),A=yield this.loadImageFromObjectUrl(E);return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:u({},a)},transformed:{objectUrl:E,image:A,size:{width:A.width,height:A.height}},exifTransform:e.exifTransform}})}loadImageFromObjectUrl(e){return new Promise((t,i)=>{let n=new Image;n.onload=()=>t(n),n.onerror=i,n.src=e})}getTransformedSize(e,t,i){let n=i.options.canvasRotation+t.rotate;if(i.options.containWithinAspectRatio)if(n%2){let a=e.width*i.options.aspectRatio,s=e.height/i.options.aspectRatio;return{width:Math.max(e.height,a),height:Math.max(e.width,s)}}else{let a=e.height*i.options.aspectRatio,s=e.width/i.options.aspectRatio;return{width:Math.max(e.width,a),height:Math.max(e.height,s)}}return n%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}};function Je(o){switch(o){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function et(o){switch(o){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function tt(o,e){switch(o){case"ArrowUp":return{clientX:0,clientY:e*-1};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};case"ArrowLeft":default:return{clientX:e*-1,clientY:0}}}var Oe=(()=>{class o{get alignImageStyle(){return this.state.options.alignImage}constructor(t,i,n){this.sanitizer=t,this.cd=i,this.zone=n,this.pinchStart$=new fe,this.cropService=new ce,this.loadImageService=new he,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.moveTypes=C,this.state=new re,this.safeImgDataUrl=ye(void 0),this.marginLeft="0px",this.imageVisible=!1,this.allowMoveImage=!1,this.checkImageType=!0,this.disabled=!1,this.hidden=!1,this.imageCropped=new z,this.startCropImage=new z,this.imageLoaded=new z,this.cropperReady=new z,this.loadImageFailed=new z,this.transformChange=new z,this.cropperChange=new z,this.reset()}ngOnInit(){this.state.stepSize=this.initialStepSize||this.state.stepSize}ngOnChanges(t){let i=this.state.cropper,n=this.state.transform,a=this.state.options.backgroundColor;if(this.state.setOptionsFromChanges(t),this.onChangesInputImage(t),t.transform&&this.transform&&(this.state.transform=this.transform,this.setCssTransform()),!this.state.loadedImage?.transformed.image.complete||!this.state.maxSize)return;if(this.containWithinAspectRatio&&t.aspectRatio||t.containWithinAspectRatio||t.canvasRotation){this.loadImageService.transformLoadedImage(this.state.loadedImage,this.state).then(r=>this.setLoadedImage(r)).catch(r=>this.loadImageError(r));return}t.cropper&&this.cropper&&(this.state.cropper=U(this.cropper,this.state,!0));let s=!this.state.equalsCropperPosition(i);s&&(!this.cropper||!this.state.equalsCropperPosition(this.cropper))&&this.cropperChange.emit(this.state.cropper),(s||!this.state.equalsTransform(n)||this.state.options.backgroundColor!==a)&&this.doAutoCrop(),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){let t=this.imageChangedEvent?.target?.files;return t instanceof FileList&&t.length>0}reset(){this.safeImgDataUrl.set("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="),this.state.loadedImage=void 0,this.state.maxSize=void 0,this.imageVisible=!1}loadImageFile(t){this.loadImageService.loadImageFile(t,this.state).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.state).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.state).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}setLoadedImage(t){this.state.loadedImage=t,this.safeImgDataUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.objectUrl))}loadImageError(t){console.error(t),this.loadImageFailed.emit()}setCssTransform(){let t=this.state.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.state.transform.translateH||0}${t}, ${this.state.transform.translateV||0}${t}) scaleX(`+(this.state.transform.scale||1)*(this.state.transform.flipH?-1:1)+") scaleY("+(this.state.transform.scale||1)*(this.state.transform.flipV?-1:1)+") rotate("+(this.state.transform.rotate||0)+"deg)")}imageLoadedInView(){this.state.loadedImage!=null&&(this.imageLoaded.emit(this.state.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.cropper&&(!this.maintainAspectRatio||this.state.aspectRatioIsCorrect())?(this.state.cropper=U(this.cropper,this.state,!0),this.emitCropperPositionChange(this.cropper)):(this.state.cropper=U(this.state.maxSizeCropperPosition(),this.state,!0),this.cropperChange.emit(this.state.cropper)),this.imageVisible=!0,this.cropperReady.emit(u({},this.state.maxSize)),this.doAutoCrop(),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>1}onResize(){if(this.state.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let t=u({},this.state.maxSize);this.setMaxSize(),this.state.resizeCropperPosition(t),this.cd.markForCheck()}}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){let i=+t.key;i>=1&&i<=9&&(this.state.stepSize=i)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;let n=t.shiftKey?C.Resize:C.Move,a=t.altKey?et(t.key):Je(t.key),s=tt(t.key,this.state.stepSize);t.preventDefault(),t.stopPropagation(),this.moveStart={active:!0,type:n,position:a,clientX:0,clientY:0,transform:this.state.transform,cropper:this.state.cropper},this.handleMouseMove(s),this.handleMouseUp()}startMove(t,i,n=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===C.Pinch||i===C.Drag&&!this.allowMoveImage||("preventDefault"in t&&t.preventDefault(),this.moveStart={active:!0,type:i,position:n,clientX:G(t),clientY:Z(t),transform:this.state.transform,cropper:this.state.cropper},this.initMouseMove())}initMouseMove(){te(O(document,"mousemove"),O(document,"touchmove")).pipe(ie(te(O(document,"mouseup"),O(document,"touchend"),this.pinchStart$).pipe(_e()))).subscribe({next:t=>this.zone.run(()=>{this.handleMouseMove(t),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}handleMouseMove(t){if(this.moveStart?.active){if("stopPropagation"in t&&t.stopPropagation(),"preventDefault"in t&&t.preventDefault(),this.moveStart.type===C.Move)this.state.cropper=$(Xe(t,this.moveStart),this.state,!0);else if(this.moveStart.type===C.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&(this.state.cropper=$(Ee(t,this.moveStart,this.state),this.state,!1));else if(this.moveStart.type===C.Drag){let i=G(t)-this.moveStart.clientX,n=Z(t)-this.moveStart.clientY;this.state.transform=T(u({},this.state.transform),{translateH:(this.moveStart.transform?.translateH||0)+i,translateV:(this.moveStart.transform?.translateV||0)+n}),this.setCssTransform()}}}handleMouseUp(){!this.moveStart?.active||this.moveStart?.type===C.Pinch||((!this.state.equalsCropperPosition(this.moveStart.cropper)||this.moveStart.transform&&!this.state.equalsTransform(this.moveStart.transform))&&(this.moveStart.type===C.Drag?this.transformChange.emit(this.state.transform):this.cropperChange.emit(this.state.cropper),this.doAutoCrop()),this.moveStart=void 0)}startPinch(t){this.disabled||!this.sourceImageLoaded()||t.touches.length<2||("preventDefault"in t&&t.preventDefault(),this.moveStart={active:!0,type:C.Pinch,position:"center",clientX:this.state.cropper.x1+(this.state.cropper.x2-this.state.cropper.x1)/2,clientY:this.state.cropper.y1+(this.state.cropper.y2-this.state.cropper.y1)/2,cropper:this.state.cropper},this.initPinch())}initPinch(){this.pinchStart$.next(),O(document,"touchmove").pipe(ie(O(document,"touchend"))).subscribe({next:t=>this.zone.run(()=>{this.handlePinchMove(t),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handlePinchStop(),this.cd.markForCheck()})})}handlePinchMove(t){this.moveStart?.active&&(t.preventDefault&&t.preventDefault(),this.moveStart.type===C.Pinch&&!this.cropperStaticWidth&&!this.cropperStaticHeight&&(this.state.cropper=$(Ee(t,this.moveStart,this.state),this.state,!1)),this.cd.markForCheck())}handlePinchStop(){this.moveStart?.active&&(this.state.equalsCropperPosition(this.moveStart.cropper)||(this.emitCropperPositionChange(this.moveStart.cropper),this.doAutoCrop()),this.moveStart=void 0)}setMaxSize(){if(this.sourceImage){let t=getComputedStyle(this.sourceImage.nativeElement);this.state.setMaxSize(parseFloat(t.width),parseFloat(t.height)),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.state.maxSize.width/2+"px)")}}emitCropperPositionChange(t){this.state.equalsCropperPosition(t)||this.cropperChange.emit(this.state.cropper)}doAutoCrop(){this.state.options.autoCrop&&this.crop()}crop(t=this.state.options.output){if(this.state.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),t==="blob")return this.cropToBlob();if(t==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((t,i)=>this.zone.run(()=>I(this,null,function*(){let n=yield this.cropService.crop(this.state,"blob");n?(this.imageCropped.emit(n),t(n)):i("Crop image failed")})))}cropToBase64(){let t=this.cropService.crop(this.state,"base64");return t?(this.imageCropped.emit(t),t):null}resetCropperPosition(){this.state.cropper=U(this.state.maxSizeCropperPosition(),this.state,!0),this.cropperChange.emit(this.state.cropper)}ngOnDestroy(){this.pinchStart$.complete()}static{this.\u0275fac=function(i){return new(i||o)(S(K),S(Ie),S(Me))}}static{this.\u0275cmp=j({type:o,selectors:[["image-cropper"]],viewQuery:function(i,n){if(i&1&&(ae(We,7),ae(Le,5)),i&2){let a;oe(a=se())&&(n.wrapper=a.first),oe(a=se())&&(n.sourceImage=a.first)}},hostVars:6,hostBindings:function(i,n){i&1&&x("resize",function(){return n.onResize()},!1,we),i&2&&(P("text-align",n.alignImageStyle),X("disabled",n.disabled)("ngx-ic-hidden",n.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",options:"options",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",autoCrop:"autoCrop",cropper:"cropper",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",checkImageType:"checkImageType",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange",cropperChange:"cropperChange"},standalone:!0,features:[Ce,N],decls:4,vars:10,consts:[["sourceImage",""],[3,"touchstart"],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(i,n){i&1&&(l(0,"div",1),x("touchstart",function(s){return n.startPinch(s)}),V(1,Qe,2,8,"img",2),M(2,"div",3),V(3,je,3,16,"div",4),c()),i&2&&(P("background",n.imageVisible&&n.state.options.backgroundColor),y(),R("ngIf",n.safeImgDataUrl()),y(),P("width",(n.state.maxSize==null?null:n.state.maxSize.width)||0,"px")("height",(n.state.maxSize==null?null:n.state.maxSize.height)||0,"px")("margin-left",n.alignImage==="center"?n.marginLeft:null),y(),R("ngIf",n.imageVisible))},dependencies:[ve],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:var(--cropper-move-border, 1px solid rgba(255, 255, 255, .5))}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535c;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ic-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0})}}return o})();function it(o,e){o&1&&(l(0,"p",13),w(1,"Failed to load image. Please try again."),c())}function nt(o,e){o&1&&(l(0,"p",13),w(1,"No file chosen. Please chose a file."),c())}function at(o,e){if(o&1){let t=k();l(0,"div",5)(1,"div",14)(2,"image-cropper",15),x("imageCropped",function(n){m(t);let a=h();return g(a.imageCropped(n))})("imageLoaded",function(n){m(t);let a=h();return g(a.imageLoaded(n))})("cropperReady",function(){m(t);let n=h();return g(n.cropperReady())})("loadImageFailed",function(){m(t);let n=h();return g(n.loadImageFailed())}),c()(),l(3,"div",16)(4,"h6",17),w(5,"Cropped Image: "),c(),M(6,"img",18),l(7,"a",19),w(8,"Download cropped image"),c()()()}if(o&2){let t=h();y(2),R("imageURL",t.imageUrl)("imageChangedEvent",t.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",4/3),y(4),R("src",t.croppedImage,Y)}}var Ve=class o{constructor(e){this.sanitizer=e}showImageCropper=!1;imageUrl="images/others/placeholder.jpg";isLoadImageFailed=!1;isNoFileChosen=!1;imageChangedEvent=null;croppedImage="";ngOnInit(){this.imageUrl&&(this.showImageCropper=!0)}fileChangeEvent(e){this.showImageCropper=!1,e.target?.files?.length?(this.imageChangedEvent=e,this.showImageCropper=!0,this.isLoadImageFailed=!1,this.isNoFileChosen=!1,this.imageUrl=""):(this.isNoFileChosen=!0,this.isLoadImageFailed=!1)}imageCropped(e){this.croppedImage=this.sanitizer.bypassSecurityTrustUrl(e.objectUrl||""),document.querySelector("#croppedImageDownload").setAttribute("href",e.objectUrl)}imageLoaded(e){}cropperReady(){}loadImageFailed(){this.showImageCropper=!1,this.isLoadImageFailed=!0,this.isNoFileChosen=!1,console.log("Failed to load image")}static \u0275fac=function(t){return new(t||o)(S(K))};static \u0275cmp=j({type:o,selectors:[["app-cropper"]],standalone:!0,features:[N],decls:29,vars:3,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"text-secondary"],["href","https://github.com/Mawi137/ngx-image-cropper","target","_blank"],["type","file",1,"form-control","mb-3",3,"change"],[1,"text-danger"],[1,"col-md-8"],["format","png",1,"border",3,"imageCropped","imageLoaded","cropperReady","loadImageFailed","imageURL","imageChangedEvent","maintainAspectRatio","aspectRatio"],[1,"col-md-4"],[1,"text-secondary","mb-3"],[1,"w-100","border",3,"src"],["href","","id","croppedImageDownload","download","cropped-image.png",1,"btn","btn-outline-primary","mt-2"]],template:function(t,i){t&1&&(l(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),w(4,"Advanced UI"),c()(),l(5,"li",4),w(6,"Image Cropper"),c()()(),l(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h4",9),w(12,"Ngx-Image-Cropper"),c(),l(13,"p",10),w(14,"Read the "),l(15,"a",11),w(16," Official Ngx-Image-Cropper Plugin Documentation "),c(),w(17,"for a full list of instructions and other options."),c()()()()(),l(18,"div",5)(19,"div",6)(20,"div",7)(21,"div",8)(22,"h6",9),w(23,"Basic Example"),c(),l(24,"div")(25,"input",12),x("change",function(a){return i.fileChangeEvent(a)}),c(),V(26,it,2,0,"p",13)(27,nt,2,0,"p",13),c(),V(28,at,9,5,"div",5),c()()()()),t&2&&(y(26),q(i.isLoadImageFailed?26:-1),y(),q(i.isNoFileChosen?27:-1),y(),q(i.showImageCropper?28:-1))},dependencies:[ze,Re,Oe],encapsulation:2})};export{Ve as CropperComponent};
