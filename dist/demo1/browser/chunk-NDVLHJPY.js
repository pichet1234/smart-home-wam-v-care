import{a as me,e as pe}from"./chunk-FHPH46MZ.js";import{g as ue}from"./chunk-ZBGVERMW.js";import"./chunk-LVHII46P.js";import{d as ee}from"./chunk-RD6NJ7NY.js";import{Ba as ae,Fa as ne,Gb as q,Ka as Q,Pa as le,Sb as v,Tb as _,Ub as R,dc as ce,ha as X,ka as Z,kb as J,na as N,qc as M,ra as se,rb as he,ta as re,xc as j,yc as oe}from"./chunk-3TFDHLSU.js";import{a as F,g as ie}from"./chunk-GAL4ENT6.js";var i=function(c){return c.SEPARATOR="separator",c.PERCENT="percent",c.IP="IP",c.CPF_CNPJ="CPF_CNPJ",c.MONTH="M",c.MONTHS="M0",c.MINUTE="m",c.HOUR="h",c.HOURS="H",c.MINUTES="m0",c.HOURS_HOUR="Hh",c.SECONDS="s0",c.HOURS_MINUTES_SECONDS="Hh:m0:s0",c.EMAIL_MASK="A*@A*.A*",c.HOURS_MINUTES="Hh:m0",c.MINUTES_SECONDS="m0:s0",c.DAYS_MONTHS_YEARS="d0/M0/0000",c.DAYS_MONTHS="d0/M0",c.DAYS="d0",c.DAY="d",c.SECOND="s",c.LETTER_S="S",c.DOT=".",c.COMMA=",",c.CURLY_BRACKETS_LEFT="{",c.CURLY_BRACKETS_RIGHT="}",c.MINUS="-",c.OR="||",c.HASH="#",c.EMPTY_STRING="",c.SYMBOL_STAR="*",c.SYMBOL_QUESTION="?",c.SLASH="/",c.WHITE_SPACE=" ",c.NUMBER_ZERO="0",c.NUMBER_NINE="9",c.BACKSPACE="Backspace",c.DELETE="Delete",c.ARROW_LEFT="ArrowLeft",c.ARROW_UP="ArrowUp",c.DOUBLE_ZERO="00",c}(i||{}),K=new Z("ngx-mask config"),fe=new Z("new ngx-mask config"),de=new Z("initial ngx-mask config"),Ce={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showTemplate:!1,showMaskTyped:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:null,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:c=>c,outputTransformFn:c=>c,maskFilled:new Q,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},Ne=[i.HOURS_MINUTES_SECONDS,i.HOURS_MINUTES,i.MINUTES_SECONDS],Re=[i.PERCENT,i.HOURS_HOUR,i.SECONDS,i.MINUTES,i.SEPARATOR,i.DAYS_MONTHS_YEARS,i.DAYS_MONTHS,i.DAYS,i.MONTHS],Ie=(()=>{class c{_config=N(K);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;showTemplate;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression="";deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMaskWithPattern(t,e){let[a,s]=e;return this.customPattern=s,this.applyMask(t,a)}applyMask(t,e,a=0,s=!1,l=!1,u=()=>{}){if(!e||typeof t!="string")return i.EMPTY_STRING;let n=0,h="",p=!1,d=!1,k=1,T=!1,r=t,m=a;r.slice(0,this.prefix.length)===this.prefix&&(r=r.slice(this.prefix.length,r.length)),this.suffix&&r.length>0&&(r=this.checkAndRemoveSuffix(r)),r==="("&&this.prefix&&(r="");let g=r.toString().split(i.EMPTY_STRING);if(this.allowNegativeNumbers&&r.slice(n,n+1)===i.MINUS&&(h+=r.slice(n,n+1)),e===i.IP){let f=r.split(i.DOT);this.ipError=this._validIP(f),e="099.099.099.099"}let x=[];for(let f=0;f<r.length;f++)r[f]?.match("\\d")&&x.push(r[f]??i.EMPTY_STRING);if(e===i.CPF_CNPJ&&(this.cpfCnpjError=x.length!==11&&x.length!==14,x.length>11?e="00.000.000/0000-00":e="000.000.000-00"),e.startsWith(i.PERCENT)){if(r.match("[a-z]|[A-Z]")||r.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!l){r=this._stripToDecimal(r);let C=this.getPrecision(e);r=this.checkInputPrecision(r,C,this.decimalMarker)}let f=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;if(r.indexOf(f)>0&&!this.percentage(r.substring(0,r.indexOf(f)))){let C=r.substring(0,r.indexOf(f)-1);this.allowNegativeNumbers&&r.slice(n,n+1)===i.MINUS&&!l&&(C=r.substring(0,r.indexOf(f))),r=`${C}${r.substring(r.indexOf(f),r.length)}`}let o="";this.allowNegativeNumbers&&r.slice(n,n+1)===i.MINUS?o=`${i.MINUS}${r.slice(n+1,n+r.length)}`:o=r,this.percentage(o)?h=this._splitPercentZero(r):h=this._splitPercentZero(r.substring(0,r.length-1))}else if(e.startsWith(i.SEPARATOR)){(r.match("[w\u0430-\u044F\u0410-\u042F]")||r.match("[\u0401\u0451\u0410-\u044F]")||r.match("[a-z]|[A-Z]")||r.match(/[-@#!$%\\^&*()_£¬'+|~=`{}\]:";<>.?/]/)||r.match("[^A-Za-z0-9,]"))&&(r=this._stripToDecimal(r));let f=this.getPrecision(e),o=Array.isArray(this.decimalMarker)?this.thousandSeparator===i.DOT?i.COMMA:i.DOT:this.decimalMarker;if(f===0?r=this.allowNegativeNumbers?r.length>2&&r[0]===i.MINUS&&r[1]===i.NUMBER_ZERO&&r[2]!==this.thousandSeparator&&r[2]!==i.COMMA&&r[2]!==i.DOT?"-"+r.slice(2,r.length):r[0]===i.NUMBER_ZERO&&r.length>1&&r[1]!==this.thousandSeparator&&r[1]!==i.COMMA&&r[1]!==i.DOT?r.slice(1,r.length):r:r.length>1&&r[0]===i.NUMBER_ZERO&&r[1]!==this.thousandSeparator&&r[1]!==i.COMMA&&r[1]!==i.DOT?r.slice(1,r.length):r:(r[0]===o&&r.length>1&&(r=i.NUMBER_ZERO+r.slice(0,r.length+1),this.plusOnePosition=!0),r[0]===i.NUMBER_ZERO&&r[1]!==o&&r[1]!==this.thousandSeparator&&(r=r.length>1?r.slice(0,1)+o+r.slice(1,r.length+1):r,this.plusOnePosition=!0),this.allowNegativeNumbers&&r[0]===i.MINUS&&(r[1]===o||r[1]===i.NUMBER_ZERO)&&(r=r[1]===o&&r.length>2?r.slice(0,1)+i.NUMBER_ZERO+r.slice(1,r.length):r[1]===i.NUMBER_ZERO&&r.length>2&&r[2]!==o?r.slice(0,2)+o+r.slice(2,r.length):r,this.plusOnePosition=!0)),l){let S=r.slice(this._findFirstNonZeroDigitIndex(r),r.length),b=r[m]===i.NUMBER_ZERO||r[m]===o,P=r[0]===i.NUMBER_ZERO,V=r[0]===i.MINUS,G=r[0]===this.thousandSeparator,Y=r[1]===o,B=r[1]===i.NUMBER_ZERO,z=r[2]===o;P&&Y&&b&&m<2&&(r=S),V&&B&&z&&b&&m<3&&(r=i.MINUS+S),S!==i.MINUS&&(m===0&&(P||G)||this.allowNegativeNumbers&&m===1&&V&&!B)&&(r=V?i.MINUS+S:S)}let C=this._charToRegExpExpression(this.thousandSeparator),E='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(C,"");if(Array.isArray(this.decimalMarker))for(let S of this.decimalMarker)E=E.replace(this._charToRegExpExpression(S),i.EMPTY_STRING);else E=E.replace(this._charToRegExpExpression(this.decimalMarker),"");let I=new RegExp("["+E+"]");r.match(I)&&(r=r.substring(0,r.length-1)),r=this.checkInputPrecision(r,f,this.decimalMarker);let A=r.replace(new RegExp(C,"g"),"");h=this._formatWithSeparators(A,this.thousandSeparator,this.decimalMarker,f);let W=h.indexOf(i.COMMA)-r.indexOf(i.COMMA),y=h.length-r.length,L=l&&h.length<t.length&&this.separatorLimit;if((h[m-1]===this.thousandSeparator||h[m-this.prefix.length])&&this.prefix&&l)m=m-1;else if(y>0&&h[m]!==this.thousandSeparator||L){d=!0;let S=0;do this._shift.add(m+S),S++;while(S<y)}else h[m-1]===this.thousandSeparator||y===-4||y===-3||h[m]===this.thousandSeparator?(this._shift.clear(),this._shift.add(m-1)):W!==0&&m>0&&!(h.indexOf(i.COMMA)>=m&&m>3)||!(h.indexOf(i.DOT)>=m&&m>3)&&y<=0?(this._shift.clear(),d=!0,k=y,m+=y,this._shift.add(m)):this._shift.clear()}else for(let f=0,o=g[0];f<g.length&&n!==e.length;f++,o=g[f]??i.EMPTY_STRING){let C=i.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(o,e[n]??i.EMPTY_STRING)&&e[n+1]===i.SYMBOL_QUESTION)h+=o,n+=2;else if(e[n+1]===i.SYMBOL_STAR&&p&&this._checkSymbolMask(o,e[n+2]??i.EMPTY_STRING))h+=o,n+=3,p=!1;else if(this._checkSymbolMask(o,e[n]??i.EMPTY_STRING)&&e[n+1]===i.SYMBOL_STAR&&!C)h+=o,p=!0;else if(e[n+1]===i.SYMBOL_QUESTION&&this._checkSymbolMask(o,e[n+2]??i.EMPTY_STRING))h+=o,n+=3;else if(this._checkSymbolMask(o,e[n]??i.EMPTY_STRING)){if(e[n]===i.HOURS&&(this.apm?Number(o)>9:Number(o)>2)){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(e,n,g.length),f--,this.leadZeroDateTime&&(h+="0");continue}if(e[n]===i.HOUR&&(this.apm?h.length===1&&Number(h)>1||h==="1"&&Number(o)>2||r.slice(n-1,n).length===1&&Number(r.slice(n-1,n))>2||r.slice(n-1,n)==="1"&&Number(o)>2:h==="2"&&Number(o)>3||(h.slice(n-2,n)==="2"||h.slice(n-3,n)==="2"||h.slice(n-4,n)==="2"||h.slice(n-1,n)==="2")&&Number(o)>3&&n>10)){m=m+1,n+=1,f--;continue}if((e[n]===i.MINUTE||e[n]===i.SECOND)&&Number(o)>5){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(e,n,g.length),f--,this.leadZeroDateTime&&(h+="0");continue}let E=31,I=r[n],A=r[n+1],W=r[n+2],y=r[n-1],L=r[n-2],S=r.slice(n-3,n-1),b=r.slice(n-1,n+1),P=r.slice(n,n+2),V=r.slice(n-2,n);if(e[n]===i.DAY){let G=e.slice(0,2)===i.MONTHS,Y=e.slice(0,2)===i.MONTHS&&this.specialCharacters.includes(L);if(Number(o)>3&&this.leadZeroDateTime||!G&&(Number(P)>E||Number(b)>E||this.specialCharacters.includes(A))||(Y?Number(b)>E||!this.specialCharacters.includes(I)&&this.specialCharacters.includes(W)||this.specialCharacters.includes(I):Number(P)>E||this.specialCharacters.includes(A)&&!l)){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(e,n,g.length),f--,this.leadZeroDateTime&&(h+="0");continue}}if(e[n]===i.MONTH){let Y=n===0&&(Number(o)>2||Number(P)>12||this.specialCharacters.includes(A)&&!l),B=e.slice(n+2,n+3),z=S.includes(B)&&e.includes("d0")&&(this.specialCharacters.includes(L)&&Number(b)>12&&!this.specialCharacters.includes(I)||this.specialCharacters.includes(I)),ge=Number(S)<=E&&!this.specialCharacters.includes(S)&&this.specialCharacters.includes(y)&&(Number(P)>12||this.specialCharacters.includes(A)),Me=Number(P)>12&&n===5||this.specialCharacters.includes(A)&&n===5,Te=Number(S)>E&&!this.specialCharacters.includes(S)&&!this.specialCharacters.includes(V)&&Number(V)>12&&e.includes("d0"),ve=Number(S)<=E&&!this.specialCharacters.includes(S)&&!this.specialCharacters.includes(y)&&Number(b)>12;if(Number(o)>1&&this.leadZeroDateTime||Y||z||ve||Te||ge||Me&&!this.leadZeroDateTime){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(e,n,g.length),f--,this.leadZeroDateTime&&(h+="0");continue}}h+=o,n++}else this.specialCharacters.includes(o)&&e[n]===o?(h+=o,n++):this.specialCharacters.indexOf(e[n]??i.EMPTY_STRING)!==-1?(h+=e[n],n++,this._shiftStep(e,n,g.length),f--):e[n]===i.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(e,n,g.length):this.patterns[e[n]??i.EMPTY_STRING]&&this.patterns[e[n]??i.EMPTY_STRING]?.optional?(g[n]&&e!=="099.099.099.099"&&e!=="000.000.000-00"&&e!=="00.000.000/0000-00"&&!e.match(/^9+\.0+$/)&&!this.patterns[e[n]??i.EMPTY_STRING]?.optional&&(h+=g[n]),e.includes(i.NUMBER_NINE+i.SYMBOL_STAR)&&e.includes(i.NUMBER_ZERO+i.SYMBOL_STAR)&&n++,n++,f--):this.maskExpression[n+1]===i.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[n+2]??i.EMPTY_STRING)&&this._findSpecialChar(o)===this.maskExpression[n+2]&&p||this.maskExpression[n+1]===i.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[n+2]??i.EMPTY_STRING)&&this._findSpecialChar(o)===this.maskExpression[n+2]&&p?(n+=3,h+=o):this.showMaskTyped&&this.specialCharacters.indexOf(o)<0&&o!==this.placeHolderCharacter&&this.placeHolderCharacter.length===1&&(T=!0)}h.length+1===e.length&&this.specialCharacters.indexOf(e[e.length-1]??i.EMPTY_STRING)!==-1&&(h+=e[e.length-1]);let O=m+1;for(;this._shift.has(O);)k++,O++;let $=s&&!e.startsWith(i.SEPARATOR)?n:this._shift.has(m)?k:0;T&&$--,u($,d),k<0&&this._shift.clear();let H=!1;l&&(H=g.every(f=>this.specialCharacters.includes(f)));let w=`${this.prefix}${H?i.EMPTY_STRING:h}${this.showMaskTyped?"":this.suffix}`;h.length===0&&(w=this.dropSpecialCharacters?`${h}`:`${this.prefix}${h}`);let U=r.length===1&&this.specialCharacters.includes(e[0])&&r!==e[0];if(!this._checkSymbolMask(r,e[1])&&U)return"";if(h.includes(i.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(l&&h===i.MINUS)return"";w=`${i.MINUS}${this.prefix}${h.split(i.MINUS).join(i.EMPTY_STRING)}${this.suffix}`}return w}_findDropSpecialChar(t){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(e=>e===t):this._findSpecialChar(t)}_findSpecialChar(t){return this.specialCharacters.find(e=>e===t)}_checkSymbolMask(t,e){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[e]?.pattern&&this.patterns[e]?.pattern.test(t))??!1}_formatWithSeparators=(t,e,a,s)=>{let l=[],u="";if(Array.isArray(a)){let k=new RegExp(a.map(T=>"[\\^$.|?*+()".indexOf(T)>=0?`\\${T}`:T).join("|"));l=t.split(k),u=t.match(k)?.[0]??i.EMPTY_STRING}else l=t.split(a),u=a;let n=l.length>1?`${u}${l[1]}`:i.EMPTY_STRING,h=l[0]??i.EMPTY_STRING,p=this.separatorLimit.replace(/\s/g,i.EMPTY_STRING);p&&+p&&(h[0]===i.MINUS?h=`-${h.slice(1,h.length).slice(0,p.length)}`:h=h.slice(0,p.length));let d=/(\d+)(\d{3})/;for(;e&&d.test(h);)h=h.replace(d,"$1"+e+"$2");return typeof s>"u"?h+n:s===0?h:h+n.substring(0,s+1)};percentage=t=>{let e=t.replace(",","."),a=Number(this.allowNegativeNumbers&&t.includes(i.MINUS)?e.slice(1,t.length):e);return!isNaN(a)&&a>=0&&a<=100};getPrecision=t=>{let e=t.split(i.DOT);return e.length>1?Number(e[e.length-1]):1/0};checkAndRemoveSuffix=t=>{for(let e=this.suffix?.length-1;e>=0;e--){let a=this.suffix.substring(e,this.suffix?.length);if(t.includes(a)&&e!==this.suffix?.length-1&&(e-1<0||!t.includes(this.suffix.substring(e-1,this.suffix?.length))))return t.replace(a,i.EMPTY_STRING)}return t};checkInputPrecision=(t,e,a)=>{let s=t,l=a;if(e<1/0){if(Array.isArray(l)){let p=l.find(d=>d!==this.thousandSeparator);l=p||l[0]}let u=new RegExp(this._charToRegExpExpression(l)+`\\d{${e}}.*$`),n=s.match(u),h=(n&&n[0]?.length)??0;if(h-1>e){let p=h-1-e;s=s.substring(0,s.length-p)}e===0&&this._compareOrIncludes(s[s.length-1],l,this.thousandSeparator)&&(s=s.substring(0,s.length-1))}return s};_stripToDecimal(t){return t.split(i.EMPTY_STRING).filter((e,a)=>{let s=typeof this.decimalMarker=="string"?e===this.decimalMarker:this.decimalMarker.includes(e);return e.match("^-?\\d")||e===this.thousandSeparator||s||e===i.MINUS&&a===0&&this.allowNegativeNumbers}).join(i.EMPTY_STRING)}_charToRegExpExpression(t){return t&&(t===" "?"\\s":"[\\^$.|?*+()".indexOf(t)>=0?`\\${t}`:t)}_shiftStep(t,e,a){let s=/[*?]/g.test(t.slice(0,e))?a:e;this._shift.add(s+this.prefix.length||0)}_compareOrIncludes(t,e,a){return Array.isArray(e)?e.filter(s=>s!==a).includes(t):t===e}_validIP(t){return!(t.length===4&&!t.some((e,a)=>t.length!==a+1?e===i.EMPTY_STRING||Number(e)>255:e===i.EMPTY_STRING||Number(e.substring(0,3))>255))}_splitPercentZero(t){if(t===i.MINUS&&this.allowNegativeNumbers)return t;let e=typeof this.decimalMarker=="string"?t.indexOf(this.decimalMarker):t.indexOf(i.DOT),a=this.allowNegativeNumbers&&t.includes(i.MINUS)?"-":"";if(e===-1){let s=parseInt(a?t.slice(1,t.length):t,10);return isNaN(s)?i.EMPTY_STRING:`${a}${s}`}else{let s=parseInt(t.replace("-","").substring(0,e),10),l=t.substring(e+1),u=isNaN(s)?"":s.toString(),n=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;return u===i.EMPTY_STRING?i.EMPTY_STRING:`${a}${u}${n}${l}`}}_findFirstNonZeroDigitIndex(t){for(let e=0;e<t.length;e++){let a=t[e];if(a&&a>="1"&&a<="9")return e}return-1}static \u0275fac=function(e){return new(e||c)};static \u0275prov=X({token:c,factory:c.\u0275fac})}return c})(),te=(()=>{class c extends Ie{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;writingValue=!1;maskChanged=!1;_maskExpressionArray=[];triggerOnMaskChange=!1;_previousValue="";_currentValue="";_emitValue=!1;_start;_end;onChange=t=>{};_elementRef=N(le,{optional:!0});document=N(ee);_config=N(K);_renderer=N(he,{optional:!0});applyMask(t,e,a=0,s=!1,l=!1,u=()=>{}){if(!e)return t!==this.actualValue?this.actualValue:t;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():i.EMPTY_STRING,this.maskExpression===i.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),this.maskExpression===i.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),!t&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;let n=t&&typeof this.selStart=="number"?t[this.selStart]??i.EMPTY_STRING:i.EMPTY_STRING,h="",p=a;if(this.hiddenInput!==null&&!this.writingValue){let r=t&&t.length===1?t.split(i.EMPTY_STRING):this.actualValue.split(i.EMPTY_STRING);typeof this.selStart=="object"&&typeof this.selEnd=="object"?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):t!==i.EMPTY_STRING&&r.length?typeof this.selStart=="number"&&typeof this.selEnd=="number"&&(t.length>r.length?r.splice(this.selStart,0,n):t.length<r.length&&(r.length-t.length===1?l?r.splice(this.selStart-1,1):r.splice(t.length-1,1):r.splice(this.selStart,this.selEnd-this.selStart))):r=[],this.showMaskTyped&&!this.hiddenInput&&(h=this.removeMask(t)),h=this.actualValue.length&&r.length<=t.length?this.shiftTypedSymbols(r.join(i.EMPTY_STRING)):t}if(s&&(this.hiddenInput||!this.hiddenInput)&&(h=t),l&&this.specialCharacters.indexOf(this.maskExpression[p]??i.EMPTY_STRING)!==-1&&this.showMaskTyped&&!this.prefix&&(h=this._currentValue),this.deletedSpecialCharacter&&p&&(this.specialCharacters.includes(this.actualValue.slice(p,p+1))?p=p+1:e.slice(p-1,p+1)!==i.MONTHS&&(p=p-2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&this.placeHolderCharacter.length===1&&!this.leadZeroDateTime&&(h=this.removeMask(t)),this.maskChanged?h=t:h=h&&h.length?h:t,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!s&&!this.writingValue){let r=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(r),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}let d=super.applyMask(h,e,p,s,l,u);if(this.actualValue=this.getActualValue(d),this.thousandSeparator===i.DOT&&this.decimalMarker===i.DOT&&(this.decimalMarker=i.COMMA),this.maskExpression.startsWith(i.SEPARATOR)&&this.dropSpecialCharacters===!0&&(this.specialCharacters=this.specialCharacters.filter(r=>!this._compareOrIncludes(r,this.decimalMarker,this.thousandSeparator))),(d||d==="")&&(this._previousValue=this._currentValue,this._currentValue=d,this._emitValue=this._previousValue!==this._currentValue||this.maskChanged||this.writingValue||this._previousValue===this._currentValue&&s),this._emitValue&&(this.writingValue&&this.triggerOnMaskChange?requestAnimationFrame(()=>this.formControlResult(d)):this.formControlResult(d)),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?l?this.hideInput(d,this.maskExpression):`${this.hideInput(d,this.maskExpression)}${this.maskIsShown.slice(d.length)}`:d;let k=d.length,T=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(i.HOURS)){let r=this._numberSkipedSymbols(d);return`${d}${T.slice(k+r)}`}else if(this.maskExpression===i.IP||this.maskExpression===i.CPF_CNPJ)return`${d}${T}`;return`${d}${T.slice(k)}`}_numberSkipedSymbols(t){let e=/(^|\D)(\d\D)/g,a=e.exec(t),s=0;for(;a!=null;)s+=1,a=e.exec(t);return s}applyValueChanges(t,e,a,s=()=>{}){let l=this._elementRef?.nativeElement;l&&(l.value=this.applyMask(l.value,this.maskExpression,t,e,a,s),l!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(t,e){return t.split(i.EMPTY_STRING).map((a,s)=>this.patterns&&this.patterns[e[s]??i.EMPTY_STRING]&&this.patterns[e[s]??i.EMPTY_STRING]?.symbol?this.patterns[e[s]??i.EMPTY_STRING]?.symbol:a).join(i.EMPTY_STRING)}getActualValue(t){let e=t.split(i.EMPTY_STRING).filter((a,s)=>{let l=this.maskExpression[s]??i.EMPTY_STRING;return this._checkSymbolMask(a,l)||this.specialCharacters.includes(l)&&a===l});return e.join(i.EMPTY_STRING)===t?e.join(i.EMPTY_STRING):t}shiftTypedSymbols(t){let e="";return(t&&t.split(i.EMPTY_STRING).map((s,l)=>{if(this.specialCharacters.includes(t[l+1]??i.EMPTY_STRING)&&t[l+1]!==this.maskExpression[l+1])return e=s,t[l+1];if(e.length){let u=e;return e=i.EMPTY_STRING,u}return s})||[]).join(i.EMPTY_STRING)}numberToString(t){return!t&&t!==0||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(i.SEPARATOR)&&this.separatorLimit.length>14&&String(t).length>14?String(t):Number(t).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${i.MINUS}/`,i.MINUS)}showMaskInInput(t){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}else if(this.showMaskTyped){if(t){if(this.maskExpression===i.IP)return this._checkForIp(t);if(this.maskExpression===i.CPF_CNPJ)return this._checkForCpfCnpj(t)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){let t=this._elementRef?.nativeElement;t&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==t.value.replace(this.placeHolderCharacter,i.EMPTY_STRING).length&&(this.formElementProperty=["value",i.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([t,e]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,t,e))}checkDropSpecialCharAmount(t){return t.split(i.EMPTY_STRING).filter(a=>this._findDropSpecialChar(a)).length}removeMask(t){return this._removeMask(this._removeSuffix(this._removePrefix(t)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(t){if(t===i.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;let e=[];for(let a=0;a<t.length;a++){let s=t[a]??i.EMPTY_STRING;s&&s.match("\\d")&&e.push(s)}return e.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>3&&e.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>6&&e.length<=9?this.placeHolderCharacter:(e.length>9&&e.length<=12,"")}_checkForCpfCnpj(t){let e=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,a=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(t===i.HASH)return e;let s=[];for(let l=0;l<t.length;l++){let u=t[l]??i.EMPTY_STRING;u&&u.match("\\d")&&s.push(u)}return s.length<=3?e.slice(s.length,e.length):s.length>3&&s.length<=6?e.slice(s.length+1,e.length):s.length>6&&s.length<=9?e.slice(s.length+2,e.length):s.length>9&&s.length<11?e.slice(s.length+3,e.length):s.length===11?"":s.length===12?t.length===17?a.slice(16,a.length):a.slice(15,a.length):s.length>12&&s.length<=14?a.slice(s.length+4,a.length):""}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}formControlResult(t){if(this.writingValue&&!t){this.onChange("");return}if(this.writingValue||!this.triggerOnMaskChange&&this.maskChanged){this.triggerOnMaskChange&&this.maskChanged&&this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))),this.maskChanged=!1;return}Array.isArray(this.dropSpecialCharacters)?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(t)),this.dropSpecialCharacters))))):this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===t?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))):this.onChange(this.outputTransformFn(this._toNumber(t)))}_toNumber(t){if(!this.isNumberValue||t===i.EMPTY_STRING||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return t;if(String(t).length>14&&this.maskExpression.startsWith(i.SEPARATOR))return String(t);let e=Number(t);if(this.maskExpression.startsWith(i.SEPARATOR)&&Number.isNaN(e)){let a=String(t).replace(",",".");return Number(a)}return Number.isNaN(e)?t:e}_removeMask(t,e){return this.maskExpression.startsWith(i.PERCENT)&&t.includes(i.DOT)?t:t&&t.replace(this._regExpForRemove(e),i.EMPTY_STRING)}_removePrefix(t){return this.prefix?t&&t.replace(this.prefix,i.EMPTY_STRING):t}_removeSuffix(t){return this.suffix?t&&t.replace(this.suffix,i.EMPTY_STRING):t}_retrieveSeparatorValue(t){let e=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(a=>this.dropSpecialCharacters.includes(a)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&t.includes(i.WHITE_SPACE)&&this.maskExpression.includes(i.SYMBOL_STAR)&&(e=e.filter(a=>a!==i.WHITE_SPACE)),this._removeMask(t,e)}_regExpForRemove(t){return new RegExp(t.map(e=>`\\${e}`).join("|"),"gi")}_replaceDecimalMarkerToDot(t){let e=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return t.replace(this._regExpForRemove(e),i.DOT)}_checkSymbols(t){let e=t;if(e===i.EMPTY_STRING)return e;this.maskExpression.startsWith(i.PERCENT)&&this.decimalMarker===i.COMMA&&(e=e.replace(i.COMMA,i.DOT));let a=this._retrieveSeparatorPrecision(this.maskExpression),s=this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(e));return this.isNumberValue&&a?e===this.decimalMarker?null:s.length>14?String(s):this._checkPrecision(this.maskExpression,s):s}_checkPatternForSpace(){for(let t in this.patterns)if(this.patterns[t]&&this.patterns[t]?.hasOwnProperty("pattern")){let e=this.patterns[t]?.pattern.toString(),a=this.patterns[t]?.pattern;if(e?.includes(i.WHITE_SPACE)&&a?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(t){let e=t.match(new RegExp("^separator\\.([^d]*)"));return e?Number(e[1]):null}_checkPrecision(t,e){let a=this.getPrecision(t),s=e;return t.indexOf("2")>0||this.leadZero&&Number(a)>0?(this.decimalMarker===i.COMMA&&this.leadZero&&(s=s.replace(",",".")),this.leadZero?Number(s).toFixed(Number(a)):Number(s).toFixed(2)):this.numberToString(s)}_repeatPatternSymbols(t){return t.match(/{[0-9]+}/)&&t.split(i.EMPTY_STRING).reduce((e,a,s)=>{if(this._start=a===i.CURLY_BRACKETS_LEFT?s:this._start,a!==i.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(a)?e+a:e;this._end=s;let l=Number(t.slice(this._start+1,this._end)),u=new Array(l+1).join(t[this._start-1]);if(t.slice(0,this._start).length>1&&t.includes(i.LETTER_S)){let n=t.slice(0,this._start-1);return n.includes(i.CURLY_BRACKETS_LEFT)?e+u:n+e+u}else return e+u},"")||t}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let t;return function(a){return(t||(t=ne(c)))(a||c)}})();static \u0275prov=X({token:c,factory:c.\u0275fac})}return c})();function ye(){let c=N(de),D=N(fe);return D instanceof Function?F(F({},c),D()):F(F({},c),D)}function _e(c){return[{provide:fe,useValue:c},{provide:de,useValue:Ce},{provide:K,useFactory:ye},te]}var Se=(()=>{class c{maskExpression="";specialCharacters=[];patterns={};prefix="";suffix="";thousandSeparator=" ";decimalMarker=".";dropSpecialCharacters=null;hiddenInput=null;showMaskTyped=null;placeHolderCharacter=null;shownMaskExpression=null;showTemplate=null;clearIfNotMatch=null;validation=null;separatorLimit=null;allowNegativeNumbers=null;leadZeroDateTime=null;leadZero=null;triggerOnMaskChange=null;apm=null;inputTransformFn=null;outputTransformFn=null;keepCharacterPositions=null;maskFilled=new Q;_maskValue="";_inputValue;_position=null;_code;_maskExpressionArray=[];_allowFewMaskChangeMask=!1;_justPasted=!1;_isFocused=!1;_isComposing=!1;document=N(ee);_maskService=N(te,{self:!0});_config=N(K);onChange=t=>{};onTouch=()=>{};ngOnChanges(t){let{maskExpression:e,specialCharacters:a,patterns:s,prefix:l,suffix:u,thousandSeparator:n,decimalMarker:h,dropSpecialCharacters:p,hiddenInput:d,showMaskTyped:k,placeHolderCharacter:T,shownMaskExpression:r,showTemplate:m,clearIfNotMatch:g,validation:x,separatorLimit:O,allowNegativeNumbers:$,leadZeroDateTime:H,leadZero:w,triggerOnMaskChange:U,apm:f,inputTransformFn:o,outputTransformFn:C,keepCharacterPositions:E}=t;if(e&&(e.currentValue!==e.previousValue&&!e.firstChange&&(this._maskService.maskChanged=!0),e.currentValue&&e.currentValue.split(i.OR).length>1?(this._maskExpressionArray=e.currentValue.split(i.OR).sort((I,A)=>I.length-A.length),this._setMask()):(this._maskExpressionArray=[],this._maskValue=e.currentValue||i.EMPTY_STRING,this._maskService.maskExpression=this._maskValue)),a){if(!a.currentValue||!Array.isArray(a.currentValue))return;this._maskService.specialCharacters=a.currentValue||[]}$&&(this._maskService.allowNegativeNumbers=$.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(I=>I!==i.MINUS))),s&&s.currentValue&&(this._maskService.patterns=s.currentValue),f&&f.currentValue&&(this._maskService.apm=f.currentValue),l&&(this._maskService.prefix=l.currentValue),u&&(this._maskService.suffix=u.currentValue),n&&(this._maskService.thousandSeparator=n.currentValue),h&&(this._maskService.decimalMarker=h.currentValue),p&&(this._maskService.dropSpecialCharacters=p.currentValue),d&&(this._maskService.hiddenInput=d.currentValue),k&&(this._maskService.showMaskTyped=k.currentValue,k.previousValue===!1&&k.currentValue===!0&&this._isFocused&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),T&&(this._maskService.placeHolderCharacter=T.currentValue),r&&(this._maskService.shownMaskExpression=r.currentValue),m&&(this._maskService.showTemplate=m.currentValue),g&&(this._maskService.clearIfNotMatch=g.currentValue),x&&(this._maskService.validation=x.currentValue),O&&(this._maskService.separatorLimit=O.currentValue),H&&(this._maskService.leadZeroDateTime=H.currentValue),w&&(this._maskService.leadZero=w.currentValue),U&&(this._maskService.triggerOnMaskChange=U.currentValue),o&&(this._maskService.inputTransformFn=o.currentValue),C&&(this._maskService.outputTransformFn=C.currentValue),E&&(this._maskService.keepCharacterPositions=E.currentValue),this._applyMask()}validate({value:t}){let e=typeof t=="number"?String(t):t;if(!this._maskService.validation||!this._maskValue)return null;if(this._maskService.ipError)return this._createValidationError(e);if(this._maskService.cpfCnpjError)return this._createValidationError(e);if(this._maskValue.startsWith(i.SEPARATOR)||Re.includes(this._maskValue)||this._maskService.clearIfNotMatch)return null;if(Ne.includes(this._maskValue))return this._validateTime(e);if(this._maskValue===i.EMAIL_MASK)return!/^[^@]+@[^@]+\.[^@]+$/.test(e)&&e?this._createValidationError(e):null;if(e&&e.length>=1){let a=0;if(this._maskValue.includes(i.CURLY_BRACKETS_LEFT)&&this._maskValue.includes(i.CURLY_BRACKETS_RIGHT))return this._maskValue.slice(this._maskValue.indexOf(i.CURLY_BRACKETS_LEFT)+1,this._maskValue.indexOf(i.CURLY_BRACKETS_RIGHT))===String(e.length)?null:this._createValidationError(e);if(this._maskValue.startsWith(i.PERCENT))return null;for(let s in this._maskService.patterns)if(this._maskService.patterns[s]?.optional){if(this._maskValue.indexOf(s)!==this._maskValue.lastIndexOf(s)){let l=this._maskValue.split(i.EMPTY_STRING).filter(u=>u===s).join(i.EMPTY_STRING);a+=l.length}else this._maskValue.indexOf(s)!==-1&&a++;if(this._maskValue.indexOf(s)!==-1&&e.length>=this._maskValue.indexOf(s)||a===this._maskValue.length)return null}if(this._maskValue.indexOf(i.SYMBOL_STAR)>1&&e.length<this._maskValue.indexOf(i.SYMBOL_STAR)||this._maskValue.indexOf(i.SYMBOL_QUESTION)>1&&e.length<this._maskValue.indexOf(i.SYMBOL_QUESTION))return this._createValidationError(e);if(this._maskValue.indexOf(i.SYMBOL_STAR)===-1||this._maskValue.indexOf(i.SYMBOL_QUESTION)===-1){let s=this._maskValue.split("*"),l=this._maskService.dropSpecialCharacters?this._maskValue.length-this._maskService.checkDropSpecialCharAmount(this._maskValue)-a:this.prefix?this._maskValue.length+this.prefix.length-a:this._maskValue.length-a;if(s.length===1&&e.length<l)return this._createValidationError(e);if(s.length>1){let u=s[s.length-1];if(u&&this._maskService.specialCharacters.includes(u[0])&&String(e).includes(u[0]??"")&&!this.dropSpecialCharacters){let n=t.split(u[0]);return n[n.length-1].length===u.length-1?null:this._createValidationError(e)}else return(u&&!this._maskService.specialCharacters.includes(u[0])||!u||this._maskService.dropSpecialCharacters)&&e.length>=l-1?null:this._createValidationError(e)}}if(this._maskValue.indexOf(i.SYMBOL_STAR)===1||this._maskValue.indexOf(i.SYMBOL_QUESTION)===1)return null}return t&&this.maskFilled.emit(),null}onPaste(){this._justPasted=!0}onFocus(){this._isFocused=!0}onModelChange(t){(t===i.EMPTY_STRING||t===null||typeof t>"u")&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(i.EMPTY_STRING))}onInput(t){if(this._isComposing)return;let e=t.target,a=this._maskService.inputTransformFn(e.value);if(e.type!=="number")if(typeof a=="string"||typeof a=="number"){if(e.value=a.toString(),this._inputValue=e.value,this._setMask(),!this._maskValue){this.onChange(e.value);return}let s=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;if(this.showMaskTyped&&this.keepCharacterPositions&&this._maskService.placeHolderCharacter.length===1){let h=e.value.slice(s-1,s),p=this.prefix.length,d=this._maskService._checkSymbolMask(h,this._maskService.maskExpression[s-1-p]??i.EMPTY_STRING),k=this._maskService._checkSymbolMask(h,this._maskService.maskExpression[s+1-p]??i.EMPTY_STRING),T=this._maskService.selStart===this._maskService.selEnd,r=Number(this._maskService.selStart)-p,m=Number(this._maskService.selEnd)-p,g=this._code===i.BACKSPACE||this._code===i.DELETE;if(g){if(!T)this._maskService.selStart===p?this._maskService.actualValue=`${this.prefix}${this._maskService.maskIsShown.slice(0,m)}${this._inputValue.split(this.prefix).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+p?this._maskService.actualValue=`${this._inputValue}${this._maskService.maskIsShown.slice(r,m)}`:this._maskService.actualValue=`${this.prefix}${this._inputValue.split(this.prefix).join("").slice(0,r)}${this._maskService.maskIsShown.slice(r,m)}${this._maskService.actualValue.slice(m+p,this._maskService.maskIsShown.length+p)}${this.suffix}`;else if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(s-this.prefix.length,s+1-this.prefix.length))&&T)if(r===1&&this.prefix)this._maskService.actualValue=`${this.prefix}${this._maskService.placeHolderCharacter}${e.value.split(this.prefix).join("").split(this.suffix).join("")}${this.suffix}`,s=s-1;else{let x=e.value.substring(0,s),O=e.value.substring(s);this._maskService.actualValue=`${x}${this._maskService.placeHolderCharacter}${O}`}s=this._code===i.DELETE?s+1:s}g||(!d&&!k&&T?s=Number(e.selectionStart)-1:this._maskService.specialCharacters.includes(e.value.slice(s,s+1))&&k&&!this._maskService.specialCharacters.includes(e.value.slice(s+1,s+2))?(this._maskService.actualValue=`${e.value.slice(0,s-1)}${e.value.slice(s,s+1)}${h}${e.value.slice(s+2)}`,s=s+1):d?e.value.length===1&&s===1?this._maskService.actualValue=`${this.prefix}${h}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${this.suffix}`:this._maskService.actualValue=`${e.value.slice(0,s-1)}${h}${e.value.slice(s+1).split(this.suffix).join("")}${this.suffix}`:this.prefix&&e.value.length===1&&s-p===1&&this._maskService._checkSymbolMask(e.value,this._maskService.maskExpression[s-1-p]??i.EMPTY_STRING)&&(this._maskService.actualValue=`${this.prefix}${e.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${this.suffix}`))}let l=0,u=!1;if(this._code===i.DELETE&&i.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue.length>=this._maskService.maskExpression.length-1&&this._code!==i.BACKSPACE&&this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&s<10){let h=this._inputValue.slice(s-1,s);e.value=this._inputValue.slice(0,s-1)+h+this._inputValue.slice(s+1)}if(this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&this.leadZeroDateTime&&(s<3&&Number(e.value)>31&&Number(e.value)<40||s===5&&Number(e.value.slice(3,5))>12)&&(s=s+2),this._maskService.maskExpression===i.HOURS_MINUTES_SECONDS&&this.apm&&(this._justPasted&&e.value.slice(0,2)===i.DOUBLE_ZERO&&(e.value=e.value.slice(1,2)+e.value.slice(2,e.value.length)),e.value=e.value===i.DOUBLE_ZERO?i.NUMBER_ZERO:e.value),this._maskService.applyValueChanges(s,this._justPasted,this._code===i.BACKSPACE||this._code===i.DELETE,(h,p)=>{this._justPasted=!1,l=h,u=p}),this._getActiveElement()!==e)return;if(this._maskService.plusOnePosition&&(s=s+1,this._maskService.plusOnePosition=!1),this._maskExpressionArray.length)if(this._code===i.BACKSPACE){let h=this.specialCharacters.includes(this._maskService.actualValue.slice(s-1,s)),p=this.specialCharacters.includes(this._maskService.actualValue.slice(s,s+1));this._allowFewMaskChangeMask&&!p?(s=e.selectionStart+1,this._allowFewMaskChangeMask=!1):s=h?s-1:s}else s=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;this._position=this._position===1&&this._inputValue.length===1?null:this._position;let n=this._position?this._inputValue.length+s+l:s+(this._code===i.BACKSPACE&&!u?0:l);n>this._getActualInputLength()&&(n=e.value===this._maskService.decimalMarker&&e.value.length===1?this._getActualInputLength()+1:this._getActualInputLength()),n<0&&(n=0),e.setSelectionRange(n,n),this._position=null}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof a);else{if(!this._maskValue){this.onChange(e.value);return}this._maskService.applyValueChanges(e.value.length,this._justPasted,this._code===i.BACKSPACE||this._code===i.DELETE)}}onCompositionStart(){this._isComposing=!0}onCompositionEnd(t){this._isComposing=!1,this._justPasted=!0,this.onInput(t)}onBlur(t){if(this._maskValue){let e=t.target;if(this._maskService.leadZero&&e.value.length>0&&typeof this._maskService.decimalMarker=="string"){let a=this._maskService.maskExpression,s=Number(this._maskService.maskExpression.slice(a.length-1,a.length));if(s>0){e.value=this._maskService.suffix?e.value.split(this._maskService.suffix).join(""):e.value;let l=e.value.split(this._maskService.decimalMarker)[1];e.value=e.value.includes(this._maskService.decimalMarker)?e.value+i.NUMBER_ZERO.repeat(s-l.length)+this._maskService.suffix:e.value+this._maskService.decimalMarker+i.NUMBER_ZERO.repeat(s)+this._maskService.suffix,this._maskService.actualValue=e.value}}this._maskService.clearIfNotMatchFn()}this._isFocused=!1,this.onTouch()}onClick(t){if(!this._maskValue)return;let e=t.target,a=0,s=0;e!==null&&e.selectionStart!==null&&e.selectionStart===e.selectionEnd&&e.selectionStart>this._maskService.prefix.length&&t.keyCode!==38&&this._maskService.showMaskTyped&&!this.keepCharacterPositions&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),e.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===e.value?(e.focus(),e.setSelectionRange(a,s)):e.selectionStart>this._maskService.actualValue.length&&e.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));let l=e&&(e.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:e.value);if(e&&e.value!==l&&(e.value=l),e&&e.type!=="number"&&(e.selectionStart||e.selectionEnd)<=this._maskService.prefix.length){let u=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map(n=>`\\${n}`).join("")}]+`))?.[0].length||0;e.selectionStart=this._maskService.prefix.length+u;return}e&&e.selectionEnd>this._getActualInputLength()&&(e.selectionEnd=this._getActualInputLength())}onKeyDown(t){if(!this._maskValue)return;if(this._isComposing){t.key==="Enter"&&this.onCompositionEnd(t);return}this._code=t.code?t.code:t.key;let e=t.target;if(this._inputValue=e.value,this._setMask(),e.type!=="number"){if(t.key===i.ARROW_UP&&t.preventDefault(),t.key===i.ARROW_LEFT||t.key===i.BACKSPACE||t.key===i.DELETE){if(t.key===i.BACKSPACE&&e.value.length===0&&(e.selectionStart=e.selectionEnd),t.key===i.BACKSPACE&&e.selectionStart!==0){if(this.specialCharacters=this.specialCharacters?.length?this.specialCharacters:this._config.specialCharacters,this.prefix.length>1&&e.selectionStart<=this.prefix.length)e.setSelectionRange(this.prefix.length,e.selectionEnd);else if(this._inputValue.length!==e.selectionStart&&e.selectionStart!==1)for(;this.specialCharacters.includes((this._inputValue[e.selectionStart-1]??i.EMPTY_STRING).toString())&&(this.prefix.length>=1&&e.selectionStart>this.prefix.length||this.prefix.length===0);)e.setSelectionRange(e.selectionStart-1,e.selectionEnd)}this.checkSelectionOnDeletion(e),this._maskService.prefix.length&&e.selectionStart<=this._maskService.prefix.length&&e.selectionEnd<=this._maskService.prefix.length&&t.preventDefault();let a=e.selectionStart;t.key===i.BACKSPACE&&!e.readOnly&&a===0&&e.selectionEnd===e.value.length&&e.value.length!==0&&(this._position=this._maskService.prefix?this._maskService.prefix.length:0,this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position))}this.suffix&&this.suffix.length>1&&this._inputValue.length-this.suffix.length<e.selectionStart?e.setSelectionRange(this._inputValue.length-this.suffix.length,this._inputValue.length):(t.code==="KeyA"&&t.ctrlKey||t.code==="KeyA"&&t.metaKey)&&(e.setSelectionRange(0,this._getActualInputLength()),t.preventDefault()),this._maskService.selStart=e.selectionStart,this._maskService.selEnd=e.selectionEnd}}writeValue(t){return ie(this,null,function*(){let e=t;if(typeof e=="object"&&e!==null&&"value"in e&&("disable"in e&&this.setDisabledState(!!e.disable),e=e.value),e!==null&&(e=this.inputTransformFn?this.inputTransformFn(e):e),typeof e=="string"||typeof e=="number"||e===null||typeof e>"u"){(e===null||typeof e>"u"||e==="")&&(this._maskService._currentValue="",this._maskService._previousValue="");let a=e;if(typeof a=="number"||this._maskValue.startsWith(i.SEPARATOR)){a=String(a);let s=this._maskService.currentLocaleDecimalMarker();Array.isArray(this._maskService.decimalMarker)||(a=this._maskService.decimalMarker!==s?a.replace(s,this._maskService.decimalMarker):a),this._maskService.leadZero&&a&&this.maskExpression&&this.dropSpecialCharacters!==!1&&(a=this._maskService._checkPrecision(this._maskService.maskExpression,a)),(this._maskService.decimalMarker===i.COMMA||Array.isArray(this._maskService.decimalMarker)&&this._maskService.thousandSeparator===i.DOT)&&(a=a.toString().replace(i.DOT,i.COMMA)),this.maskExpression?.startsWith(i.SEPARATOR)&&this.leadZero&&requestAnimationFrame(()=>{this._maskService.applyMask(a?.toString()??"",this._maskService.maskExpression)}),this._maskService.isNumberValue=!0}typeof a!="string"&&(a=""),this._inputValue=a,this._setMask(),a&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?(typeof this.inputTransformFn!="function"&&(this._maskService.writingValue=!0),this._maskService.formElementProperty=["value",this._maskService.applyMask(a,this._maskService.maskExpression)],typeof this.inputTransformFn!="function"&&(this._maskService.writingValue=!1)):this._maskService.formElementProperty=["value",a],this._inputValue=a}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof e)})}registerOnChange(t){this._maskService.onChange=this.onChange=t}registerOnTouched(t){this.onTouch=t}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}checkSelectionOnDeletion(t){t.selectionStart=Math.min(Math.max(this.prefix.length,t.selectionStart),this._inputValue.length-this.suffix.length),t.selectionEnd=Math.min(Math.max(this.prefix.length,t.selectionEnd),this._inputValue.length-this.suffix.length)}setDisabledState(t){this._maskService.formElementProperty=["disabled",t]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue,this._maskService.maskExpression)]}_validateTime(t){let e=this._maskValue.split(i.EMPTY_STRING).filter(a=>a!==":").length;return t&&(+(t[t.length-1]??-1)==0&&t.length<e||t.length<=e-2)?this._createValidationError(t):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(t){return{mask:{requiredMask:this._maskValue,actualValue:t}}}_setMask(){this._maskExpressionArray.some(t=>{if(t.split(i.EMPTY_STRING).some(a=>this._maskService.specialCharacters.includes(a))&&this._inputValue&&this._areAllCharactersInEachStringSame(this._maskExpressionArray)||t.includes(i.CURLY_BRACKETS_LEFT)){let a=this._maskService.removeMask(this._inputValue)?.length<=this._maskService.removeMask(t)?.length;if(a)return this._maskValue=this.maskExpression=this._maskService.maskExpression=t.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(t):t,a;{this._code===i.BACKSPACE&&(this._allowFewMaskChangeMask=!0);let s=this._maskExpressionArray[this._maskExpressionArray.length-1]??i.EMPTY_STRING;this._maskValue=this.maskExpression=this._maskService.maskExpression=s.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(s):s}}else{let a=this._maskService.removeMask(this._inputValue)?.split(i.EMPTY_STRING).every((s,l)=>{let u=t.charAt(l);return this._maskService._checkSymbolMask(s,u)});if(a||this._justPasted)return this._maskValue=this.maskExpression=this._maskService.maskExpression=t,a}})}_areAllCharactersInEachStringSame(t){let e=this._maskService.specialCharacters;function a(l){let u=new RegExp(`[${e.map(n=>`\\${n}`).join("")}]`,"g");return l.replace(u,"")}return t.map(a).every(l=>new Set(l).size===1)}static \u0275fac=function(e){return new(e||c)};static \u0275dir=re({type:c,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,a){e&1&&ce("paste",function(){return a.onPaste()})("focus",function(l){return a.onFocus(l)})("ngModelChange",function(l){return a.onModelChange(l)})("input",function(l){return a.onInput(l)})("compositionstart",function(l){return a.onCompositionStart(l)})("compositionend",function(l){return a.onCompositionEnd(l)})("blur",function(l){return a.onBlur(l)})("click",function(l){return a.onClick(l)})("keydown",function(l){return a.onKeyDown(l)})},inputs:{maskExpression:[0,"mask","maskExpression"],specialCharacters:"specialCharacters",patterns:"patterns",prefix:"prefix",suffix:"suffix",thousandSeparator:"thousandSeparator",decimalMarker:"decimalMarker",dropSpecialCharacters:"dropSpecialCharacters",hiddenInput:"hiddenInput",showMaskTyped:"showMaskTyped",placeHolderCharacter:"placeHolderCharacter",shownMaskExpression:"shownMaskExpression",showTemplate:"showTemplate",clearIfNotMatch:"clearIfNotMatch",validation:"validation",separatorLimit:"separatorLimit",allowNegativeNumbers:"allowNegativeNumbers",leadZeroDateTime:"leadZeroDateTime",leadZero:"leadZero",triggerOnMaskChange:"triggerOnMaskChange",apm:"apm",inputTransformFn:"inputTransformFn",outputTransformFn:"outputTransformFn",keepCharacterPositions:"keepCharacterPositions"},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],standalone:!0,features:[j([{provide:me,useExisting:c,multi:!0},{provide:pe,useExisting:c,multi:!0},te]),ae]})}return c})();var ke=class c{static \u0275fac=function(t){return new(t||c)};static \u0275cmp=se({type:c,selectors:[["app-input-mask"]],standalone:!0,features:[j([_e()]),oe],decls:71,vars:2,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"text-secondary"],["href","https://github.com/JsDaddy/ngx-mask","target","_blank"],[1,"col-md-12","grid-margin"],[1,"forms-sample"],[1,"row","mb-3"],[1,"col"],[1,"form-label"],["mask","d0/M0/0000","placeholder","dd/mm/yyyy",1,"form-control","mb-4","mb-md-0"],[1,"col-md-6"],["mask","Hh:m0:s0","placeholder","hh:mm:ss",1,"form-control"],["mask","d0/M0/0000 Hh:m0:s0","placeholder","dd/mm/yyyy hh:mm:ss",1,"form-control","mb-4","mb-md-0"],["mask","AAA 000-S0S","placeholder","AAA 000-S0S",1,"form-control"],["prefix","+7 ","mask","(000) 000 00 00",1,"form-control","mb-4","mb-md-0",3,"showMaskTyped"],["suffix"," $","mask","0000",1,"form-control"],["mask","separator",1,"form-control","mb-4","mb-md-0"],["mask","separator.2","thousandSeparator",".",1,"form-control","mb-4","mb-md-0"],["mask","separator.2","thousandSeparator",",",1,"form-control"],["mask","XXX/X0/0000","placeholder","XXX/X0/0000",1,"form-control","mb-4","mb-md-0",3,"hiddenInput"]],template:function(t,e){t&1&&(v(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),M(4,"Forms"),_()(),v(5,"li",2)(6,"a",3),M(7,"Advanced Elements"),_()(),v(8,"li",4),M(9,"Input Mask"),_()()(),v(10,"div",5)(11,"div",6)(12,"div",7)(13,"div",8)(14,"h4",9),M(15,"Input Mask"),_(),v(16,"p",10),M(17,"Read the "),v(18,"a",11),M(19," Official Ngx-mask Documentation "),_(),M(20,"for a full list of instructions and other options."),_()()()()(),v(21,"div",5)(22,"div",12)(23,"div",7)(24,"div",8)(25,"form",13)(26,"div",14)(27,"div",15)(28,"label",16),M(29,"Date:"),_(),R(30,"input",17),_(),v(31,"div",18)(32,"label",16),M(33,"Hour:"),_(),R(34,"input",19),_()(),v(35,"div",14)(36,"div",18)(37,"label",16),M(38,"Date hour:"),_(),R(39,"input",20),_(),v(40,"div",18)(41,"label",16),M(42,"Mixed types:"),_(),R(43,"input",21),_()(),v(44,"div",14)(45,"div",18)(46,"label",16),M(47,"Prefix:"),_(),R(48,"input",22),_(),v(49,"div",18)(50,"label",16),M(51,"Suffix (eg: $):"),_(),R(52,"input",23),_()(),v(53,"div",14)(54,"div",18)(55,"label",16),M(56,"Thousand separator:"),_(),R(57,"input",24),_(),v(58,"div",18)(59,"label",16),M(60,"Dot separator:"),_(),R(61,"input",25),_()(),v(62,"div",14)(63,"div",18)(64,"label",16),M(65,"Comma separator:"),_(),R(66,"input",26),_(),v(67,"div",18)(68,"label",16),M(69,"Secure input:"),_(),R(70,"input",27),_()()()()()()()),t&2&&(J(48),q("showMaskTyped",!0),J(22),q("hiddenInput",!0))},dependencies:[ue,Se],encapsulation:2})};export{ke as InputMaskComponent};
